define("application",["client","request","tile","ufo"],function(e,t,n,r){var i=function(e){var t=this;this.init(),$(window).on("auth-success",function(n,r){console.log("auth success"),t.client.setAuth(arguments[1]),t.client.connection.emit("client-update",t.client.getData()),t.initTile(e),t.client.login(function(e){t.client.setData(e),console.log("setting client from server registry",e)})})};return i.prototype={init:function(){var n=this,r={auth:null,location:"A",floor:"2",state:1};this.setClient(new e(r)),this.client.response(function(e){console.log("server-response",e)}),this.client.request(function(e){e.sender.id!==n.client.options.id&&auth.etag===e.sender.auth.etag&&(console.log("server-request",auth.etag,e.sender.auth.etag),(new Function(n.getFunctionBody(e.render)))(e.content,e.html),(new Function(e.callback))())}),this.client.pairRequest(),this.setRequest(new t),this.request.init({sender:this.client.getData()})},initTile:function(e){var t=this;$(".throw").unbind();var r={html:function(){return e.html()}(),render:function(){var e=document.createElement("div");e.className="throw",e.style.position="absolute",e.width=255,e.height=140;var n=document.createElement("div");n.id="ufo",n.style.backgroundImage="/static/images/ufo.png",n.style.position="absolute",n.width=255,n.height=140,e.appendChild(n);var r=document.createElement("div");r.id="beam",r.style.backgroundImage="/static/images/beam.png",r.style.position="absolute",r.style.opacity=1,r.width=400,r.height=450,e.appendChild(r),document.body.appendChild(e),$(e).append(arguments[1]),$(".throw").on("dispatch",function(e,n){var r=arguments[1];t.request.setCallback(r.callback),t.request.setRender(r.render),t.request.setHtml(r.html),t.client.connection.emit("client-request-update",t.request.get(),function(){console.log("request sent",t.request.get())})})},mousedown:function(){TweenMax.killTweensOf(e)},selector:".throw",pageX:200,pageY:200};tile=new n,tile.create(r),$(".throw").on("dispatch",function(){var e=arguments[1];t.request.setCallback(e.callback),t.request.setRender(e.render),t.request.setHtml(e.html),t.client.connection.emit("client-request-update",t.request.get(),function(){console.log("request sent",t.request.get())})})},setRequest:function(e){this.request=e},setClient:function(e){this.client=e},getFunctionBody:function(e){return e.substring(e.indexOf("{")+1,e.lastIndexOf("}"))}},i});